<div class="container">
    <h2>Welcome <% if (user) { %>
            <%= user %>
                <% } else { %>
                    User
                    <% } %>
    </h2>


<% if (blogPosts && blogPosts.length> 0) { %>
    <% blogPosts.forEach(post=> { %>
        <div class="managementContainer">
            <a href="/blog/admin/post/<%= post._id %>" class="blogContainer container">
                <h3>
                    <%= post.title %>
                </h3>
                <p>
                    <%= post.container %>
                </p>
            </a>
            <div class="actionButtons">
            <button type="button" onclick="window.location.href='/blog/admin/edit/<%= post._id %>'">Edit</button>
            <br>
            <button type="button" onclick="deletePost('<%= post._id %>')">Delete</button>
            </div>
        </div>
        <% }) %>
            <% } else { %>
                <p>No blog posts available.</p>
                <% } %>

                    <a href="/blog/admin/create">Create New Post</a>
</div>

                    <script>
                        const deletePost = async (id) => {
                            try {
                                if (confirm("Do you want to delete this blog post?"))
                                    await fetch(`/blog/admin/delete/${id}`, { method: 'DELETE' }).then((response) => response.ok ? window.location.href = '/blog/admin' : alert("Failed to delete post"));
                            } catch (error) {
                                alert("An unexpected error occurred");
                            }
                        }


                    </script>